Zadanie 12

SELECT EMPNO, ENAME, SAL, DEPTNO, (SELECT MIN(SAL) FROM EMP E2 WHERE E1.DEPTNO = E2.DEPTNO) MIN, (SELECT AVG(SAL) FROM EMP E3 WHERE E1.DEPTNO = E3.DEPTNO) AVG, (SELECT MAX(SAL) FROM EMP E4 WHERE E1.DEPTNO = E4.DEPTNO) MAX FROM EMP E1 ORDER BY DEPTNO;

DRUGA WERSJA
SELECT EMPNO, ENAME, SAL, DEPTNO ,MIN, AVG,MAX FROM EMP1 NATURAL JOIN (SELECT DEPTNO, MIN(SAL) MIN, AVG(SAL) AVG, MAX(SAL) MAX FROM EMP GROUP BY DEPTNO) ORDER BY DEPTNO;

Zadanie 13
SELECT E1.DEPTNO, D.DNAME, (SELECT COUNT(E2.EMPNO) FROM EMP E2 WHERE E1.DEPTNO = E2.DEPTNO) COUNT, (SELECT AVG(E3.SAL) FROM EMP E3 WHERE E1.DEPTNO = E3.DEPTNO) AVG, COUNT(*) COUNT_LOCAL, AVG(E1.SAL) AVG_LOCAL FROM EMP E1, DEPT D WHERE E1.DEPTNO = D.DEPTNO AND E1.SAL > (SELECT AVG(E5.SAL) FROM EMP E5 WHERE E1.DEPTNO = E5.DEPTNO) GROUP BY E1.DEPTNO, D.DNAME;

Zadamoe 14
wartości :
brak działu 20
reszta identycznie jak 13 zadanie  

SELECT E1.DEPTNO, D.DNAME, (SELECT COUNT(E2.EMPNO) FROM EMP E2 WHERE E1.DEPTNO = E2.DEPTNO) COUNT, (SELECT AVG(E3.SAL)FROM EMP E3 WHERE E1.DEPTNO = E3.DEPTNO) AVG, COUNT(*) COUNT_LOCAL, AVG(E1.SAL) AVG_LOCAL FROM EMP E1, (SELECT DNAME, DEPTNO FROM EMP NATURAL JOIN DEPT GROUP BY DNAME, DEPTNO HAVING MIN(SAL) > (SELECT MIN(SAL) FROM EMP WHHERE DEPTNO = 20)) D WHERE E1.DEPTNO = D.DEPTNO AND E1.SAL > (SELECT AVG(E5.SAL) FROM EMP E5 WHERE E1.DEPTNO = E5.DEPTNO) GROUP BY E1.DEPTNO, D.DNAME;

